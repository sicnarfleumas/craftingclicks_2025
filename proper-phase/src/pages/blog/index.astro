---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/Layout.astro';

const posts = await getCollection('blog', ({ data }) => import.meta.env.PROD ? data.draft !== true : true);
// Sort newest first
posts.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());
---

<BaseLayout title="Blog — Crafting Clicks" description="Insights on SEO, performance and growth from Crafting Clicks">
  <section class="mx-auto max-w-5xl px-4 py-12">
    <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight">Insights & Articles</h1>
    <p class="mt-2 text-neutral-600">Latest thoughts on SEO, performance, and digital growth.</p>

    <div class="mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2">
      {posts.map((post) => (
        <a href={`/blog/${post.id}`} class="group rounded-xl border border-neutral-200 bg-white p-5 shadow-sm transition hover:shadow-md">
          {post.data.featuredImage && (
            <img
              src={post.data.featuredImage.src}
              width={post.data.featuredImage.width}
              height={post.data.featuredImage.height}
              alt={post.data.featuredImageAlt}
              class="mb-4 h-40 w-full rounded-lg object-cover"
              loading="lazy"
            />
          )}
          <h2 class="text-xl font-bold group-hover:text-[color:var(--cc-orange-600)]">{post.data.title}</h2>
          <p class="mt-2 line-clamp-3 text-sm text-neutral-700">{post.data.description}</p>
          <div class="mt-3 flex items-center gap-3 text-xs text-neutral-500">
            <time datetime={new Date(post.data.pubDate).toISOString()}>
              {new Date(post.data.pubDate).toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })}
            </time>
            {post.data.readingTime && (<span>• {post.data.readingTime} min read</span>)}
          </div>
        </a>
      ))}
    </div>
  </section>
  
</BaseLayout>


